#!/bin/sh

revision="setlang v0.1.0 (2022-03-12 MIB-Wiki)"
# use --help for more info

export PATH=:/proc/boot:/sbin:/bin:/usr/bin:/usr/sbin:/net/mmx/bin:/net/mmx/usr/bin:/net/mmx/usr/sbin:/net/mmx/sbin:/net/mmx/mnt/app/armle/bin:/net/mmx/mnt/app/armle/sbin:/net/mmx/mnt/app/armle/usr/bin:/net/mmx/mnt/app/armle/usr/sbin
export LD_LIBRARY_PATH=/net/mmx/mnt/app/root/lib-target:/net/mmx/mnt/eso/lib:/net/mmx/eso/lib:/net/mmx/mnt/app/usr/lib:/net/mmx/mnt/app/armle/lib:/net/mmx/mnt/app/armle/lib/dll:/net/mmx/mnt/app/armle/usr/lib
export IPL_CONFIG_DIR=/etc/eso/production

thisname="$(basename $0)"
thisdir="$(dirname $0)"

if [ -z $LOG ]; then
	. $thisdir/../config/GLOBALS
	echo -ne "\n$ME-$thisname---->\n" >> $LOG
fi

if [ -f $TMP/backup.mib ] || [ -f $TMP/reboot.mib ] || [ -f $TMP/flash.mib ]; then
	echo "Backup or reboot is already running..."
	return 2> /dev/null
fi

case $1 in

-eu) {

trap '' 2

	echo -ne "This  will enable maximum language support for each FW\n"
	if [[ "$TRAINVERSION" = *ER_VWG* ]] || [[ "$TRAINVERSION" = *ER_SKG* ]] || [[ "$TRAINVERSION" = *ER_SEG* ]]; then
		echo -ne "Set visible_MMI_language_dataset - 0x2d00 - EU\n" | $TEE -a $LOG
		echo -ne "de_DE,en_GB,fr_FR,it_IT,es_ES,nl_NL,cs_CZ,pt_PT,sv_SE,tr_TR,ru_RU,pl_PL,no_NO,en_US,es_MX,pt_BR,ar_SA,bs_BA,ro_RO,sk_SK,sl_SI,sr_RS,da_DK,el_GR,hr_HR,hu_HU,fi_FI,bg_BG,lv_LV,et_EE,lt_LT,uk_UA"
		on -f mmx $PC b:10:0xC0030006 2064655F444503656E5F47420366725F46520169745F49540165735F4553016E6C5F4E4C0163735F435A0170745F50540173765F53450174725F54520272755F525501706C5F504C016E6F5F4E4F01656E5F55530165735F4D580170745F42520161725F53410162735F424101726F5F524F01736B5F534B01736C5F53490173725F52530164615F444B01656C5F47520168725F48520168755F48550166695F46490162675F4247016C765F4C560165745F4545016C745F4C5401756B5F554101656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F47420163735F435A01656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F474201656E5F47420172755F52550130336D01
		sleep 1
		echo -ne "Set language dataset - 0x280 - en_GB\n" | $TEE -a $LOG
		on -f mmx $PC b:10:0xC0030005 656E5F474200656E5F474200656E5F4742004331E45D
		echo -ne "Language changed. DONE!\n" | $TEE -a $LOG
		sleep 1
	elif [[ "$TRAINVERSION" = *ER_POG* ]] || [[ "$TRAINVERSION" = *ER_BYSUV* ]]; then
		echo -ne "Set visible_MMI_language_dataset - 0x2d00 - EU\n" | $TEE -a $LOG
		echo -ne "de_DE,en_GB,en_SA,fr_FR,it_IT,es_ES,pt_PT,pt_BR,nl_NL,ru_RU,pl_PL,cs_CZ,es_MX,en_US,sv_SE,tr_TR,hu_HU,no_NO,ar_SA,el_GR,fi_FI,hr_HR,da_DK,sl_SI,sk_SK,sr_RS,ro_RO,bs_BA"
		on -f mmx $PC b:10:0xC0030006 2064655F444503656E5F47420366725F46520169745F49540165735F4553016E6C5F4E4C0163735F435A0170745F50540173765F53450174725F54520272755F525501706C5F504C016E6F5F4E4F01656E5F55530165735F4D580170745F42520161725F53410162735F424101726F5F524F01736B5F534B01736C5F53490173725F52530164615F444B01656C5F47520168725F48520168755F48550166695F46490162675F4247016C765F4C560165745F4545016C745F4C5401756B5F5541010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003033BC4
		sleep 1
		echo -ne "Set language dataset - 0x280 - en_GB\n" | $TEE -a $LOG
		on -f mmx $PC b:10:0xC0030005 656E5F474200656E5F474200656E5F4742004331E45D
		echo -ne "Language changed. DONE!\n" | $TEE -a $LOG
		sleep 1	
	elif [[ "$TRAINVERSION" = *ER_AU276* ]] || [[ "$TRAINVERSION" = *ER_AU43x* ]] || [[ "$TRAINVERSION" = *ER_AU37x* ]] || [[ "$TRAINVERSION" = *MHI2Q_ER_AUG22* ]] || [[ "$TRAINVERSION" = *ER_AU62x* ]]; then
		echo -ne "Set visible_MMI_language_dataset - 0x2d00 - EU\n" | $TEE -a $LOG
		echo -ne "de_DE,en_GB,en_SA,fr_FR,it_IT,es_ES,pt_PT,pt_BR,nl_NL,ru_RU,pl_PL,cs_CZ,es_MX,en_US,sv_SE,tr_TR,hu_HU,no_NO,ar_SA,da_DK,ms_MY,ro_RO,sl_SI,fi_FI,el_GR,uk_UA"
		on -f mmx $PC b:10:0xC0030006 1A64655F444503656E5F474203656E5F53410266725F46520169745F49540165735F45530170745F50540170745F4252016E6C5F4E4C0172755F525501706C5F504C0163735F435A0165735F4D5801656E5F55530173765F53450174725F54520268755F4855016E6F5F4E4F0161725F53410164615F444B016D735F4D5900726F5F524F01736C5F53490166695F464901656C5F475201756B5F5541010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003033DAE5
		sleep 1
		echo -ne "Set language dataset - 0x280 - en_GB\n" | $TEE -a $LOG
		on -f mmx $PC b:10:0xC0030005 656E5F474200656E5F474200656E5F4742004331E45D
		echo -ne "Language changed. DONE!\n" | $TEE -a $LOG
		sleep 1	
	elif [[ "$TRAINVERSION" = *ER_AUG22* ]]; then
		echo -ne "Set visible_MMI_language_dataset - 0x2d00 - EU\n" | $TEE -a $LOG
		echo -ne "de_DE,en_GB,en_SA,fr_FR,it_IT,es_ES,pt_PT,pt_BR,nl_NL,ru_RU,pl_PL,cs_CZ,es_MX,en_US,sv_SE,tr_TR,hu_HU,no_NO,ar_SA"
		on -f mmx $PC b:10:0xC0030006 1364655F444503656E5F474203656E5F53410266725F46520169745F49540165735F45530170745F50540170745F4252016E6C5F4E4C0172755F525501706C5F504C0163735F435A0165735F4D5801656E5F55530173765F53450174725F54520268755F4855016E6F5F4E4F0161725F5341010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003033AB9A
		sleep 1
		echo -ne "Set language dataset - 0x280 - en_GB\n" | $TEE -a $LOG
		on -f mmx $PC b:10:0xC0030005 656E5F474200656E5F474200656E5F4742004331E45D
		echo -ne "Language changed. DONE!\n" | $TEE -a $LOG
		sleep 1	
	elif [[ "$TRAINVERSION" = *ER_AUG57x* ]]; then
		echo -ne "visible_MMI_language_dataset - 0x2d00 - EU\n" | $TEE -a $LOG
		echo -ne "de_DE,en_GB,en_SA,fr_FR,it_IT,es_ES,pt_PT,pt_BR,nl_NL,ru_RU,pl_PL,cs_CZ,es_MX,en_US,sv_SE,tr_TR,ar_SA,en_SA"
		on -f mmx $PC b:10:0xC0030006 1264655F444503656E5F474203656E5F53410266725F46520169745F49540165735F45530170745F50540170745F4252016E6C5F4E4C0172755F525501706C5F504C0163735F435A0165735F4D5801656E5F55530173765F53450174725F54520261725F534101656E5F5341020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003033BA10
		sleep 1
		echo -ne "language dataset - 0x280 - en_GB\n" | $TEE -a $LOG
		on -f mmx $PC b:10:0xC0030005 656E5F474200656E5F474200656E5F4742004331E45D
		echo -ne "Language changed. DONE!\n" | $TEE -a $LOG
		sleep 1		
	else
		echo -ne "no supported train found - will stop here\n" | $TEE -a $LOG
	fi

	#echo -ne "store changes to persistence\n"
	on -f mmx $PC b:0:1 0
	echo -ne "Go back and reboot unit to apply changes\n"

trap 2

return 2> /dev/null

	};;

-ar) {

trap '' 2

	if [[ "$TRAINVERSION" = *ER* ]]; then
		echo -ne "visible_MMI_language_dataset - 0x2d00 - Arabic only\n" | $TEE -a $LOG
		echo -ne "en_GB,ar_SA"
		on -f mmx $PC b:10:0xC0030006 02656E5F47420261725F5341020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003332C898
		sleep 1
		echo -ne "language dataset - 0x280 - ar_SA\n" | $TEE -a $LOG
		on -f mmx $PC b:10:0xC0030005 61725F53410161725F53410161725F5341014431A8FF
		sleep 1
		echo -ne "Language changed. DONE!\n" | $TEE -a $LOG
		sleep 1		
	else
		echo -ne "no EU train found - will stop here\n" | $TEE -a $LOG
	fi

	#echo -ne "store changes to persistence\n"
	on -f mmx $PC b:0:1 0
	echo -ne "Go back and reboot unit to apply changes\n"

trap 2

return 2> /dev/null


};;

-nar) {

trap '' 2

	if [[ "$TRAINVERSION" = *US* ]]; then
		echo -ne "visible_MMI_language_dataset - 0x2d00 - NAR\n" | $TEE -a $LOG
		echo -ne "en_US,es_MX,fr_CA"
		on -f mmx $PC b:10:0xC0030006 03656E5F55530166725F43410165735F4D58010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003431E3E4
		sleep 1
		echo -ne "language dataset - 0x280 - en_US\n" | $TEE -a $LOG
		on -f mmx $PC b:10:0xC0030005 656e5f555300656e5f555300656e5f5553004530c9a6
		sleep 1
		echo -ne "Language changed. DONE!\n" | $TEE -a $LOG
		sleep 1		
	else
		echo -ne "no US train found - will stop here\n" | $TEE -a $LOG
	fi

	#echo -ne "store changes to persistence\n"
	on -f mmx $PC b:0:1 0
	echo -ne "Go back and reboot unit to apply changes\n"

trap 2

return 2> /dev/null

};;
	
-jp) {

trap '' 2

	if [[ "$TRAINVERSION" = *JP* ]]; then
		echo -ne "visible_MMI_language_dataset - 0x2d00 - Japan\n" | $TEE -a $LOG
		echo -ne "ja_JP,en_US"
		on -f mmx $PC b:10:0xC0030006 02656e5f5553016a615f4a5001656e5f555301656e5f555301000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000363090a9
		sleep 1
		echo -ne "language dataset - 0x280 - ja_JP\n" | $TEE -a $LOG
		on -f mmx $PC b:10:0xC0030005 6a615f4a50006a615f4a50006a615f4a500033335be3
		sleep 1
		echo -ne "Language changed. DONE!\n" | $TEE -a $LOG
		sleep 1		
	else
		echo -ne "no JP train found - will stop here\n" | $TEE -a $LOG
	fi

	#echo -ne "store changes to persistence\n"
	on -f mmx $PC b:0:1 0
	echo -ne "Go back and reboot unit to apply changes\n"

trap 2

return 2> /dev/null


};;

-kr) {

trap '' 2

	if [[ "$TRAINVERSION" = *KR* ]]; then
		echo -ne "visible_MMI_language_dataset - 0x2d00 - Korea\n" | $TEE -a $LOG
		echo -ne "ko_KR,en_KR"
		on -f mmx $PC b:10:0xC0030006 026b6f5f4b5201656e5f4b52010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003731cc83
		sleep 1
		echo -ne "language dataset - 0x280 - ko_KR\n" | $TEE -a $LOG
		on -f mmx $PC b:10:0xC0030005 6b6f5f4b52006b6f5f4b52006b6f5f4b52004c30a910
		sleep 1
		echo -ne "Language changed. DONE!\n" | $TEE -a $LOG
		sleep 1		
	else
		echo -ne "no KR train found - will stop here\n" | $TEE -a $LOG
	fi

	#echo -ne "store changes to persistence\n"
	on -f mmx $PC b:0:1 0
	echo -ne "Go back and reboot unit to apply changes\n"

trap 2

return 2> /dev/null


};;
	
-tw) {

trap '' 2

	if [[ "$TRAINVERSION" = *TW* ]]; then
		echo -ne "visible_MMI_language_dataset - 0x2d00 - Taiwan\n" | $TEE -a $LOG
		echo -ne "zh_TW,en_US"
		on -f mmx $PC b:10:0xC0030006 027a685f545701656e5f5457010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003831ba2c
		sleep 1
		echo -ne "language dataset - 0x280 - zh_TW\n" | $TEE -a $LOG
		on -f mmx $PC b:10:0xC0030005 7a685f5457007a685f5457007a685f5457004a307125
		sleep 1
		echo -ne "Language changed. DONE!\n" | $TEE -a $LOG
		sleep 1		
	else
		echo -ne "no TW train found - will stop here\n" | $TEE -a $LOG
	fi

	#echo -ne "store changes to persistence\n"
	on -f mmx $PC b:0:1 0
	echo -ne "Go back and reboot unit to apply changes\n"

trap 2

return 2> /dev/null


};;

-cn) {

trap '' 2

	if [[ "$TRAINVERSION" = *CN* ]]; then
		echo -ne "visible_MMI_language_dataset - 0x2d00 - China\n" | $TEE -a $LOG
		echo -ne "zh_CN,zh_HK,en_CN"
		on -f mmx $PC b:10:0xC0030006 037a685f434e017a685f484b01656e5f434e0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000035318ba2
		sleep 1
		echo -ne "language dataset - 0x280 - zh_CN\n" | $TEE -a $LOG
		on -f mmx $PC b:10:0xC0030005 7a685f434e007a685f434e007a685f434e004830a705
		sleep 1
		echo -ne "Language changed. DONE!\n" | $TEE -a $LOG
		sleep 1		
	else
		echo -ne "no CN train found - will stop here\n" | $TEE -a $LOG
	fi

	#echo -ne "store changes to persistence\n"
	on -f mmx $PC b:0:1 0
	echo -ne "Go back and reboot unit to apply changes\n"

trap 2

return 2> /dev/null

};;


# help or unknown parameter ------------------------------
	*) {
		echo ""
		echo $revision
		echo ""
		echo "Usage: "$thisname" [OPTION]"
		echo ""
		echo "Options:"
		echo "        -eu 		set EU languages"
		echo "        -ar 		set Arabic language"
		echo "        -nar 		set NAR language"
		echo "        -kr 		set Korean language"
		echo "        -tw 		set Taiwan language"
		echo "        -cn		set Chinese language"
		echo "        -jp 		set Japan language"
		echo "        --help		show this help"
		echo ""
		echo "Note: Backup will only work in RCC bash!"
		echo ""
		echo "This program is free software; you can redistribute it and/or"
		echo "modify it under the terms of the GNU General Public License"
		echo "as published by the Free Software Foundation; either version 2"
		echo "of the License, or (at your option) any later version."
		echo ""
		echo "This program is distributed in the hope that it will be useful,"
		echo "but WITHOUT ANY WARRANTY; without even the implied warranty of"
		echo "MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."
		echo "See the GNU General Public License for more details."
		echo ""
		echo "You should have received a copy of the GNU General Public License"
		echo "along with this program; if not, write to the Free Software Foundation,"
		echo "Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA."
		echo ""
		
	};;
	
	esac

exit 0

